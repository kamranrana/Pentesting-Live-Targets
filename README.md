# Project 8 - Pentesting Live Targets

Time spent: **9** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

Vulnerability #1: **SQL Injection (SQLi)**
* I first saw that in the Menu the "Users" "Salespeople" and "Countries, States and Territories" all had an id field in the browser
* I first tried to do an Insecure Direct Object Reference attack on the id field, which did not work for any of them
* Then, I looked at the hints tab and tried to use the SQL Injection given to us which was `' OR SLEEP(5)=0--'`
* This SQL Injection did not work for the "Users" or "Countries, States and Territories", but it worked for the "Salespeople"
* In order to confirm that the SQL injection worked I changed the code to be `' OR SLEEP(30)=0--'` and confirmed that it slept for 30 seconds
* The other two sites were sanitizing the SQL input while this site was not
* **GIF WALKTHROUGH**: https://imgur.com/a/ZHbVyRq

Vulnerability #2: **Session Hijacking/Fixation**
* I felt like this attack was the most straightforward of the six attacks because of the `change_session_id.php` script provided
* I followed the assignment guide and used two different browsers (Firefox and Chrome) to carry out the attack
* The attack that I carried out was session hijacking
* First, I logged in the target into the staff area and using the `change_session_id.php` script I got the session id
* Then, I used the `change_session_id.php` script with the attacker to change the session to that of the target
* Then, the attacker was able to access the staff area because the blue site did not expire their active sessions
* **GIF WALKTHROUGH**: https://imgur.com/a/oC1cRBa

## Green

Vulnerability #1: **Cross-Site Scripting (XSS)**
* For the XSS vulnerability, I was looking for a text box where I could inject my JavaScript for all three sites
* I tried injecting the JavaScript for the red, blue and green sites, but it only worked on the green site
* For the green site, I found that the "Feedback" field in the "Contact" tab was vulnerable to XSS
* When we submit something to the "Contact Us" form, a logged in user can see it in the "Feedback" section
* I used the script `<script>alert('Kamran K Rana found the XSS!');</script>` given to us in the "Contact Us" form to exploit the XSS vulnerability
* As a regular user, I submitted the XSS through the "Contact" tab, and then as a logged in user I saw the XSS in the "Feedback" tab
* The other two sites were sanitizing the input in the form while this site was not
* **GIF WALKTHROUGH**: https://imgur.com/a/pTPrAwV

Vulnerability #2: **Username Enumeration**
* For this vulnerability, I knew it had something to do with login so I tried it on all three sites, but only the green site worked
* I used the username "jmonroe99" given to us in order to test this vulnerability 
* After testing this on all three sites to determine a difference I found one on the green site
* When a username that is valid such as "jmonroe99" but a wrong password is entered it dispalys "Log in was unsuccessful." in bold
* When a username that is invalid such as "kamranisthebest" and a wrong password is entered it displays "Log in was unsuccessful." not in bold
* I confirmed this again by using a valid username such as "pperson" and an invalid password, which displayed the error message in bold
* This vulnerability allows an attacker to determine usernames which are valid on the site and not valid on the site
* The red and blue site do not allow this attack because "Log in was unsuccessful." is always displayed in bold on these sites
* **GIF WALKTHROUGH**: https://imgur.com/a/YMx3Lz9

## Red

Vulnerability #1: **Insecure Direct Object Reference (IDOR)**
* After trail and error, I found that the red site had an insecure direct object reference because a not logged in user was able to 
access objects of the site that were not allowed to be accessed
* I first went to the Staff Menu under Salespeople and saw that two objects that seemed suspicious because they were in all capital letters
* These two objects were Lazy	Lazyman (FIRED FOR STEALING) and Testy	McTesterson (NOT PUBLIC UNTIL SEPT. 1)
* When I clicked on these two objects while logged in I saw that their id values were 11 and 10, respectively
* While logged out, I clicked on "Find a Salesperson" and saw that these two objects were inaccessible 
* Then I tried to put their ids in directly into the browser and found the IDOR vulnerability
* The other two sites were cross checking that the id was accessible publicly while this site was not
* **GIF WALKTHROUGH**: https://imgur.com/a/jgadusv

Vulnerability #2: **Cross-Site Request Forgery (CSRF)**
* This was one of the hardest vulnerabilities to find because of how deep and intricate it was
* I first did some research online and got help from my TA in order to create a self-submitting HTML form
* Once I created the self-submitting form, I saved it on my computer in order to test out the vulnerability
* First, I went on the public website to find a target. I chose Irene Boling with the `id=3`
* My goal for this attack was to modify Irene Boling's name within the database
* I submitted my HTML form to the feedback section and waited for a logged-in user to submit my HTML form
* Once the logged in user visited my hidden HTML form, then it takes advantage of the user's credentials and modifies 
  Irene Bolings's name within the database
* **GIF WALKTHROUGH**: https://imgur.com/a/JQg5kYd

## Notes

I felt like a lot of this weeks assignment was trial and error. The assignment guide that was provided to us by the CodePath
website was extremely helpful in order to figure out how to carry out the attacks. I looked at the guide and then figured
out how to carry out the attacks, and then just tested them out on the Green, Blue and Red sites. Then through the process
of elimination, I was able to narrow down the attacks and their targets. 
